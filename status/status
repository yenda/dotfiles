#/bin/bash

# kill dev server 
lsof -i :8081 | awk 'NR!=1 {print $2}' | xargs kill

# In gnome-terminal, go to Edit -> Profile Preferences -> Title. Click the Command tab. Select Hold the terminal from the drop-down menu labelled When command exits. Name the profile hold-terminal

echo "Starting Android Emulator"
AVD_NAME=$1

~/Android/Sdk/emulator/emulator -avd ${AVD_NAME:-wallet} -wipe-data &

cd status-react

echo "Cleaning up..."
#_ rm -rf node_modules
rm package-lock.json
rm -rf target
rm index.android.js
lein clean

make startdev-android-avd

echo "you can now use M-x cider-connect-clojurescript to connect to the repl"
echo "in the repl use '(figwheel-sidecar.repl-api/cljs-repl)' to open a cljs-repl"
# (figwheel-sidecar.repl-api/cljs-repl)